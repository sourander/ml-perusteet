
<!doctype html>
<html lang="fi" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../intuitio/">
      
      
        <link rel="next" href="../metsa/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Puu - Johdatus Koneoppimiseen</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#informaation-kasvu" class="md-skip">
          Hyppää sisältöön
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Ylätunniste">
    <a href="../../.." title="Johdatus Koneoppimiseen" class="md-header__button md-logo" aria-label="Johdatus Koneoppimiseen" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Johdatus Koneoppimiseen
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Puu
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Hae" placeholder="Hae" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Haku">
        
        <button type="reset" class="md-search__icon md-icon" title="Tyhjää" aria-label="Tyhjää" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Aloitetaan hakua
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigaatio" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Johdatus Koneoppimiseen" class="md-nav__button md-logo" aria-label="Johdatus Koneoppimiseen" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Johdatus Koneoppimiseen
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tervetuloa kurssille
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Koneoppiminen
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Koneoppiminen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../koneoppiminen/yleista/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Yleistä
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../koneoppiminen/miksi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Miksi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../koneoppiminen/tyypit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tyypit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../koneoppiminen/tyonkulku/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Työnkulku
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data/datasetti/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasetti
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data/enkoodaus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enkoodaus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data/skaalaus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Skaalaus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data/jakauma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jakauma
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data/suorituskyky/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mallin suorituskyky
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Algoritmit
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Algoritmit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bayes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Bayes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bayes/intuitio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intuitio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bayes/naive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Naive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bayes/tehtavat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📝 Tehtävät
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Puut
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Puut
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intuitio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intuitio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Puu
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Puu
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#informaation-kasvu" class="md-nav__link">
    <span class="md-ellipsis">
      Informaation kasvu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esimerkki-pyoralla-vai-autolla" class="md-nav__link">
    <span class="md-ellipsis">
      Esimerkki: Pyörällä vai autolla?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Esimerkki: Pyörällä vai autolla?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datan-esittely" class="md-nav__link">
    <span class="md-ellipsis">
      Datan esittely
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-luomiskertomus" class="md-nav__link">
    <span class="md-ellipsis">
      Datan luomiskertomus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#juuritason-solmun-valinta" class="md-nav__link">
    <span class="md-ellipsis">
      Juuritason solmun valinta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Juuritason solmun valinta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tulos" class="md-nav__link">
    <span class="md-ellipsis">
      Tulos:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tulos:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graafi" class="md-nav__link">
    <span class="md-ellipsis">
      Graafi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-jaot" class="md-nav__link">
    <span class="md-ellipsis">
      Datan jaot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tason-1-solmun-valinta" class="md-nav__link">
    <span class="md-ellipsis">
      Tason 1 solmun valinta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tason 1 solmun valinta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tulos_1" class="md-nav__link">
    <span class="md-ellipsis">
      Tulos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tulos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graafi_1" class="md-nav__link">
    <span class="md-ellipsis">
      Graafi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-jaot_1" class="md-nav__link">
    <span class="md-ellipsis">
      Datan jaot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tason-2-solmun-valinta" class="md-nav__link">
    <span class="md-ellipsis">
      Tason 2 solmun valinta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tason 2 solmun valinta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tulos_2" class="md-nav__link">
    <span class="md-ellipsis">
      Tulos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tulos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graafi_2" class="md-nav__link">
    <span class="md-ellipsis">
      Graafi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-jaot_2" class="md-nav__link">
    <span class="md-ellipsis">
      Datan jaot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mita-opimme-esimerkista" class="md-nav__link">
    <span class="md-ellipsis">
      Mitä opimme esimerkistä?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metsä
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tehtavat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📝 Tehtävät
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Etäisyys
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Etäisyys
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distance/knn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    k-NN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distance/kMeans/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    k-Means
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distance/tehtavat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📝 Tehtävät
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linear
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Linear
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linear/normal_equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Normaaliyhtälö
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linear/hill_climbing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hill Climbing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linear/gradient_descent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gradient descent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linear/logistic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logistic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linear/tehtavat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📝 Tehtävät
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#informaation-kasvu" class="md-nav__link">
    <span class="md-ellipsis">
      Informaation kasvu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esimerkki-pyoralla-vai-autolla" class="md-nav__link">
    <span class="md-ellipsis">
      Esimerkki: Pyörällä vai autolla?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Esimerkki: Pyörällä vai autolla?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datan-esittely" class="md-nav__link">
    <span class="md-ellipsis">
      Datan esittely
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-luomiskertomus" class="md-nav__link">
    <span class="md-ellipsis">
      Datan luomiskertomus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#juuritason-solmun-valinta" class="md-nav__link">
    <span class="md-ellipsis">
      Juuritason solmun valinta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Juuritason solmun valinta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tulos" class="md-nav__link">
    <span class="md-ellipsis">
      Tulos:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tulos:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graafi" class="md-nav__link">
    <span class="md-ellipsis">
      Graafi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-jaot" class="md-nav__link">
    <span class="md-ellipsis">
      Datan jaot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tason-1-solmun-valinta" class="md-nav__link">
    <span class="md-ellipsis">
      Tason 1 solmun valinta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tason 1 solmun valinta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tulos_1" class="md-nav__link">
    <span class="md-ellipsis">
      Tulos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tulos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graafi_1" class="md-nav__link">
    <span class="md-ellipsis">
      Graafi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-jaot_1" class="md-nav__link">
    <span class="md-ellipsis">
      Datan jaot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tason-2-solmun-valinta" class="md-nav__link">
    <span class="md-ellipsis">
      Tason 2 solmun valinta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tason 2 solmun valinta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tulos_2" class="md-nav__link">
    <span class="md-ellipsis">
      Tulos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tulos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graafi_2" class="md-nav__link">
    <span class="md-ellipsis">
      Graafi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datan-jaot_2" class="md-nav__link">
    <span class="md-ellipsis">
      Datan jaot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mita-opimme-esimerkista" class="md-nav__link">
    <span class="md-ellipsis">
      Mitä opimme esimerkistä?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Puu</h1>

<p>Aiemmassa osiossa esitelty entropia on päätöspuun rakentamisen keskeinen käsite. Entropia on datan epäpuhtauden tai epäjärjestyksen mitta. Tavoitteena on <mark>minimoida entropia</mark> jakamalla data tavalla, joka erottaa luokat mahdollisimman puhtaasti. Tässä osiossa tutustutaan siihen, kuinka kunkin oksan informaation kasvu lasketaan: eli siis, kuinka valitaan paras ominaisuus, jolla data jaetaan.</p>
<p>Arvaa kuka?-pelin logiikassa tämä olisi parhaan kysymyksen valinta. Kuvitellaan, että olemme luomassa koneoppimismallia, joka pyrkii ennustamaan, että <em>"Onko kysyjän valitsema hahmo naisoletettu"</em>. Yksinkertaisuuden vuoksi pelissä on leikisti vain 5 eri featurea (<code>parta|silmälasit|hattu|pitkät hiukset|kauluspaita</code>). Alla on kuvitteellinen esimerkki ensimmäisen kysymyksen valinnasta:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Onko hänellä parta? (Score: 0.44)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Onko hänellä silmälasit? (Score: 0.33)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Onko hänellä hattu? (Score: 0.22)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Onko hänellä pitkät hiukset? (Score: 0.11)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Onko hänellä kauluspaita? (Score: 0.00)</li>
</ul>
<p>Kukin kysymys jakaisi datasetin kahteen osaan: heihin joilla tämä piirre on, ja heihin, joilta se puuttuu. Meidän kuvitteellisen Arvaa kuka?-pelin datasetissä ei ole laisinkaan parrakkaita naisia, mutta on useampi parraton jotakin muuta sukupuolta edustava henkilö. Jako tapahtuisi seuraavalla tavalla:</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Input Data</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c1">#</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1">#        the rest with beards                     women without beards</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1">#        ┌────────┴─────────┐            ┌──────────────────┴──────────────────┐                     </span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">beard</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1">#                            └─────┬────┘</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1">#                       the rest without beards</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Split the data into two partitions by beardedness</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">beardless</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">beard</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">beard</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">beard</span><span class="p">]</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">bearded</span>   <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">beard</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">beard</span><span class="p">)</span> <span class="k">if</span> <span class="n">beard</span><span class="p">]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="c1">#        the rest without beards</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1">#             ┌────┴───┐</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># beardless: [0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># bearded:   [0, 0, 0, 0, 0, 0, 0]</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1">#             └────────┬────────┘</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1">#            the rest with beards</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="c1"># Compute the entropy after the split</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">score</span> <span class="o">=</span> <span class="n">some_magic_function</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">beardless</span><span class="p">,</span> <span class="n">bearded</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">stdout</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Score: 0.44
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Huomaa, että tämä esimerkki ei ota kantaa siihen, mikä on nainen tai voiko naisella olla partaa. Tässä <strong>Arvaa Kuka?-tyylisen, kuvitteellisen pelin populaatiossa</strong> esiintyy vain kahta luokkaa: <code>0</code> ja <code>1</code>, joista luokka <code>1</code> ovat naiseksi identifioituvat henkilöt. Luokka 0 ovat kaikki muut sukupuolet ("the rest").</p>
</div>
<p>Tarkkasilmäinen huomaa, että esimerkissä on käytetty <code>some_magic_function</code>-funktiota, jota ei ole vielä esitelty. Se on funktio, joka laskee informaation kasvun (yllä ympäripyöreästi <em>"score"</em>). Aiemmin esitelty entropia on yksi osa informaation kasvun laskemista. Tähän kaavaan tutustutaan alla.</p>
<h2 id="informaation-kasvu">Informaation kasvu</h2>
<p>Informaation kasvu (engl. information gain) on päätöspuun rakentamisen keskeinen käsite. Se on laskettu erotuksena vanhemman solmun (engl. parent node) entropiasta ja painotetusta keskiarvosta sen lasten (engl. child nodes) entropioista. Mitä suurempi informaation kasvu, sitä parempi, koska se osoittaa, että datan jakaminen valitun ominaisuuden perusteella vähentää epävarmuutta kohdearvosta. Yllä olevassa esimerkissä parrakkuus on hyvä valinta, koska se tuottaa suuremman informaation kasvun kuin muut ominaisuudet (kuten silmälälasit tai hattu).</p>
<p>Kaava on:</p>
<div class="arithmatex">\[
IG(S, a) = H(S) - H(S|a)
\]</div>
<p>Tämä voidaan kirjoittaa auki muotoon:</p>
<div class="arithmatex">\[
IG(S, a) = H(S) - \sum_{v \in values(a)} \frac{|S_{v}|}{|S|} H(S_{v})
\]</div>
<p>Missä:</p>
<ul>
<li><span class="arithmatex">\(H(S)\)</span> : on vanhemman solmun entropia (eli <code>y</code>-arvojen entropia)</li>
<li><span class="arithmatex">\(a\)</span> : on valittu ominaisuus eli piirre</li>
<li><span class="arithmatex">\(v \in values(a)\)</span> : on ominaisuuden <span class="arithmatex">\(a\)</span> mahdolliset arvot</li>
<li><span class="arithmatex">\(S_v\)</span> : on S:n data niissä indekseissä, joissa <span class="arithmatex">\(a\)</span> on <span class="arithmatex">\(v\)</span> (<code>child1</code> tai <code>child2</code>)</li>
<li><span class="arithmatex">\(H(S_v)\)</span> : on lasten solmun <span class="arithmatex">\(v\)</span> entropia</li>
</ul>
<p>Kaavassa pystypalkit <span class="arithmatex">\(|S|\)</span> ja <span class="arithmatex">\(|S_v|\)</span> tarkoittavat joukon kardinaalisuutta, eli kuinka monta alkiota joukossa on. Käytännössä se on sama asia kuin <code>len(X)</code>. Jakolaskun tulona on siis: <em>"Kuinka suuri osa piirteen <span class="arithmatex">\(a\)</span> arvoista on <span class="arithmatex">\(v\)</span>"</em>. </p>
<p>Python-koodina informaation kasvun laskeminen näyttää tältä:</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">class_probabilities</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>  <span class="c1"># What&#39;s this?(1)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">zeros</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">ones</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">zeros</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">ones</span> <span class="o">/</span> <span class="n">n</span><span class="p">]</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># This is the some_magic_function() from the previous example</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">information_gain</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">child1</span><span class="p">,</span> <span class="n">child2</span><span class="p">):</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="c1"># H(S) - Entropy of parent node</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="n">H_S</span> <span class="o">=</span> <span class="n">entropy</span><span class="p">(</span><span class="n">class_probabilities</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="c1"># |S| - Cardinality of parent node</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="c1"># S_v - Data of each child node</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="n">S_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">child1</span><span class="p">,</span> <span class="n">child2</span><span class="p">]</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>    <span class="c1"># |S_v| - Cardinality of each child node</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>    <span class="n">n_S_v</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S_v</span><span class="p">]</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>    <span class="c1"># H(X_v) - Entropy of each child node</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>    <span class="n">H_S_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">entropy</span><span class="p">(</span><span class="n">class_probabilities</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S_v</span><span class="p">]</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>    <span class="c1"># Formula</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>    <span class="n">IG</span> <span class="o">=</span> <span class="n">H_S</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">n_S_v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">H_S_v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">S_v</span><span class="p">))])</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>    <span class="k">return</span> <span class="n">IG</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="c1"># Dataset X</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="n">X</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="c1">#   x0, x1, y</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="c1">#  ┌─────&gt; x[0] =&gt; 1/3 equals true</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1">#  │</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="c1">#  ┘ ┌───&gt; x[1] =&gt; 3/5 equals true</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1">#  ──┤</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="c1">#    │</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1">#  ──┘</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="p">]</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a><span class="n">n_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_columns</span><span class="p">):</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>    <span class="n">parent</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>    <span class="n">child1</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">X</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># v in values(a) == 1</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>    <span class="n">child2</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">X</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># v in values(a) == 0</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>    <span class="n">ig</span> <span class="o">=</span> <span class="n">information_gain</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">child1</span><span class="p">,</span> <span class="n">child2</span><span class="p">)</span>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> information gain: </span><span class="si">{</span><span class="n">ig</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<ol>
<li>This function returns a list of two probabilities. A probability of class 0 and probability of class 1.
    <div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">assert</span> <span class="n">class_probabilities</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
</span></code></pre></div></li>
</ol>
<p>Koosteena:</p>
<ul>
<li>Matala entropia (tai korkea puhtaus) on toivottavaa jokaisessa puun solmussa.</li>
<li>Korkea informaation kasvu osoittaa, että valittu ominaisuus tarjoaa hyödyllistä tietoa datan jakamiseen ja on siksi toivottava päätöspuun rakentamiseen.</li>
</ul>
<h2 id="esimerkki-pyoralla-vai-autolla">Esimerkki: Pyörällä vai autolla?</h2>
<p>Luodaan päätöspuu, joka pyrkii generalisoimaan kulkuvälineen valinnan päätöspuun avulla. Huomaa, että tässä esimerkissä saatetaan käyttää joitakin pseudofunktioita, joita ei olla käytännössä määritelty missään. Tarkoituksena on havainnollistaa informaation kasvun laskemista; varsinainen käyttövalmiimpi koodi on muualla harjoitustehtävissä esillä. Tuotantoon soveltuvaa koodia emme kirjoita laisinkaan tämän kurssin aikana: käytä tähän Scikit-learn-kirjastoa.</p>
<h3 id="datan-esittely">Datan esittely</h3>
<p>Datasettiin kuuluu 4 saraketta (eli piirrettä, <em>featurea</em>) ja 16 riviä (eli havaintoa, <em>observation</em>). Sarakkeet ovat:</p>
<ul>
<li>Olen levännyt (0 = False, 1 = True)</li>
<li>Määränpäässä on suihku (0 = False, 1 = True)</li>
<li>Minimivauhti, jolla ehtisin perille. (x.xx km/h)</li>
<li>Havainnossa on menty autolla (0 = False, 1 = True)</li>
</ul>
<p>Viimeinen sarake on se label, jota me yritämme ennustaa. Datasetti näyttää tältä:</p>
<table>
<thead>
<tr>
<th>im_well_rested</th>
<th>dst_has_shower</th>
<th>required_speed</th>
<th>go_by_car</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>10.63</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>71.09</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>42.95</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>24.53</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>53.66</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>71.79</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>5.88</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>57.5</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>25.32</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>34.39</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>56.91</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>64.6</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>17.46</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>87.61</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>14.2</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>8.28</td>
<td>0</td>
</tr>
</tbody>
</table>
<h3 id="datan-luomiskertomus">Datan luomiskertomus</h3>
<p>Havaintoavaruuden kolme ensimmäistä saraketta (eli piirteet) on generoitu satunnaislukuja käyttäen. Viimeinen sarake, eli label <code>go_by_car</code>, on generoitu seuraavalla logiikalla:</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">transportation_mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="p">(</span><span class="n">required_speed</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">|</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="p">((</span><span class="n">well_rested</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">required_speed</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">))</span> <span class="o">|</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="p">((</span><span class="n">has_shower</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">required_speed</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)),</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="p">)</span>
</span></code></pre></div>
<p>Lauseena <code>go_by_car</code>-sarakkeen logiikka on: <strong>mene autolla, jos</strong> jokin seuraavista on totta:</p>
<ul>
<li>Vaadittu nopeus on 20 km/h</li>
<li>En ole levännyt ja vaadittu nopeus on 15 km/h</li>
<li>Määränpäässä ei ole suihkua ja vaadittu nopeus on 10 km/h</li>
</ul>
<h3 id="juuritason-solmun-valinta">Juuritason solmun valinta</h3>
<p>Varsinainen koodi kannattaa kirjoittaa rekursiiviseksi, koska kunkin oksanhaaran kohdalla logiikka on tismalleen sama. Tässä esimerkissä työ tehdään kuitenkin käsin, jotta vaiheet tulevat selvästi esille. Ensimmäinen solmu valitaan laskemalla informaation kasvu jokaiselle piirteelle ja valitsemalla suurin informaation kasvu.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Kuljettu polku selviää muuttujan nimestä. Esimerkiksi <code>root_l_r_r</code> on päätöspuun polku, jossa dataa on jaettu ensin vasemmalle, sitten oikealle ja lopuksi taas oikealle.</p>
</div>
<p>Alla olevassa koodissa <code>find_max_column_information_gain()</code>-funktio laskee informaation kasvun jokaiselle piirteelle (levänneisyys, suihkullisuus ja nopeus) ja palauttaa suurimman informaation kasvun tuottavan sarakkeen indeksin. Tämän jälkeen <code>split_data()</code>-funktio jakaa datan valitun piirteen perusteella kahteen osaan.</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">ig_root</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">find_max_column_information_gain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root node: </span><span class="si">{</span><span class="n">ig_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># Splitting score: IGScore(</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1">#   column_index=2, </span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">#   column_type=&#39;continuous&#39;, </span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c1">#   score=0.39279019935806186, </span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1">#   split_point=20.995</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1"># )</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="n">root_l</span><span class="p">,</span> <span class="n">root_r</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ig_root</span><span class="p">)</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Toivon mukaan pohdit nyt, että kuinka ei-binäärisestä piirteestä, nopeudesta, voidaan poimia split point. Tähän olisi monta mahdollista strategiaa, kuten:</p>
<ul>
<li><strong>Vaihtoehto 1: Käytä mediaania</strong>. Tämä tuskin johtaa optimaaliseen ratkaisuun, mutta on nopea ja helppo tapa jakaa dataa.</li>
<li><strong>Vaihtoehto 2: Laske kaikki mahdolliset split pointit</strong>. Tämä on kallis operaatio, mutta antaa tarkan kuvan siitä, mikä split point on paras. Jos data olisi esimerkiksi <code>[1.0, 2.0, 3.0, 4.0, 5.0]</code>, mahdolliset split pointit olisivat kaikkien näiden lukujen väliin asettuvat luvut: <code>[1.5, 2.5, 3.5, 4.5]</code>.</li>
</ul>
<p>Me valitsemme jälkimmäisen vaihtoehdon.</p>
</div>
<h4 id="tulos">Tulos:</h4>
<p>Päätöspuu on saanut ensimmäisen haaransa, joka vastaa kysymykseen:</p>
<p><strong>Sinä</strong> <img alt="🤔" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f914.svg" title=":thinking:" /> : "Hmm, pitäisikö minun pyöräillä vai mennä autolla määränpäähän?"</p>
<p><strong>Puu</strong> <img alt="🌴" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f334.svg" title=":palm_tree:" /> : "Ah, tämä riippuu siitä, kuinka kauas sinun pitää päästä ja kuinka äkkiä. Onko vaadittu nopeus suurempi kuin 20.995 km/h?".</p>
<h5 id="graafi">Graafi</h5>
<pre class="mermaid"><code>graph TD
    ROOT[Nopeus?] --&gt;|#60;20.995| ROOT_L_QUIZ[Seuraava kysymys]
    ROOT --&gt;|#62;#61;20.995| ROOT_R_LEAF((Autolla))</code></pre>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Graafissa pyöreä solmu tarkoittaa päätössolmua, joka ei jaa dataa enää. Suorakulmio tarkoittaa kysymystä, joka jakaa dataa kahteen osaan. Englanniksi nämä ovat <em>leaf node</em>, eli siis puun lehti, ja <em>decision node</em> tai <strong>branch node</strong>, eli siis oksanhaara.</p>
</div>
<h5 id="datan-jaot">Datan jaot</h5>
<p>Klikkaa seuraavat laatikot auki nähdäksesi, mitkä rivit ovat osallistuneet kunkin informaation kasvun laskentaan.</p>
<details class="question">
<summary>Vasen oksa</summary>
<table>
<thead>
<tr>
<th>im_well_rested</th>
<th>dst_has_shower</th>
<th>required_speed</th>
<th>go_by_car</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>10.63</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>5.88</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>17.46</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>14.2</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>8.28</td>
<td>0</td>
</tr>
</tbody>
</table>
</details>
<details class="question">
<summary>Oikea lehti</summary>
<table>
<thead>
<tr>
<th>im_well_rested</th>
<th>dst_has_shower</th>
<th>required_speed</th>
<th>go_by_car</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>71.09</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>42.95</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>24.53</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>53.66</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>71.79</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>57.5</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>25.32</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>34.39</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>56.91</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>64.6</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>87.61</td>
<td>1</td>
</tr>
</tbody>
</table>
</details>
<h3 id="tason-1-solmun-valinta">Tason 1 solmun valinta</h3>
<p>Juuritaso, eli taso 0, on nyt luotu. Toinen oksa haarautui suoraan lehteen, joten sitä on turha jatkaa. <code>root_r</code> on siis lehti. Seuraavaksi valitaan <code>root_l</code>-solmun lapsista uusi juuritaso.</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">ig_depth_1</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">find_max_column_information_gain</span><span class="p">(</span><span class="n">root_l</span><span class="p">)</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Splitting score: </span><span class="si">{</span><span class="n">ig_depth_1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c1"># Splitting score: IGScore(</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c1">#   column_index=1, </span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1">#   column_type=&#39;binary&#39;, </span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c1">#   score=0.4199730940219749, </span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c1">#   split_point=0.5</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c1"># )</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">root_l_l</span><span class="p">,</span> <span class="n">root_l_r</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ig_depth_1</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="tulos_1">Tulos</h4>
<p>Jotta voit päätyä tähän tilanteeseen, sinulla täytyy olla nopeutta vähemmän kuin 20.995 km/h. Seuraavaksi eniten informaation kasvua paljastavaksi kysymykseksi on osoittautunut, onko määränpäässä suihku.</p>
<h5 id="graafi_1">Graafi</h5>
<pre class="mermaid"><code>graph TD
    ROOT[Nopeus?] --&gt;|#60;20.995| ROOT_L[Suihku?]
    ROOT --&gt;|#62;#61;20.995| ROOT_R_LEAF((Autolla))

    ROOT_L --&gt;|Ei| ROOT_L_L_QUIZ[Seuraava kysymys]
    ROOT_L --&gt;|Kyllä| R_L_R_LEAF((Pyörällä))</code></pre>
<h5 id="datan-jaot_1">Datan jaot</h5>
<details class="question">
<summary>Vasen oksa</summary>
<table>
<thead>
<tr>
<th>im_well_rested</th>
<th>dst_has_shower</th>
<th>required_speed</th>
<th>go_by_car</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>10.63</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>5.88</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>14.2</td>
<td>1</td>
</tr>
</tbody>
</table>
</details>
<details class="question">
<summary>Oikea lehti</summary>
<table>
<thead>
<tr>
<th>im_well_rested</th>
<th>dst_has_shower</th>
<th>required_speed</th>
<th>go_by_car</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>17.46</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>8.28</td>
<td>0</td>
</tr>
</tbody>
</table>
</details>
<h3 id="tason-2-solmun-valinta">Tason 2 solmun valinta</h3>
<p>Juuritaso ja Taso 1 päättyivät kumpikin tilanteeseen, jossa toinen oksa (<code>root_l_r</code>) osoittautui lehdeksi. Meillä on taas helppo tilanne edessä, jossa meidän täytyy laskea vain toisen oksan informaation kasvu.</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">ig_depth_2</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">find_max_column_information_gain</span><span class="p">(</span><span class="n">root_l_l</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Splitting score: </span><span class="si">{</span><span class="n">ig_depth_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1"># Splitting score: IGScore(</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1">#   column_index=2, </span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1">#   column_type=&#39;continuous&#39;,</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1">#   score=0.9182958340544896,</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c1">#   split_point=8.255</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1">#   )</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="n">root_l_l_l</span><span class="p">,</span> <span class="n">root_l_l_r</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">root_l_l</span><span class="p">,</span> <span class="n">ig_depth_2</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="tulos_2">Tulos</h4>
<p>Jotta voit päätyä tähän tilanteeseen, sinulla täytyy olla nopeutta vähemmän kuin 20.995 km/h ja määränpäässä ei saa olla suihkua. Seuraavaksi eniten informaation kasvua paljastavaksi kysymykseksi on osoittautunut, onko vaadittu nopeus suurempi kuin 8.255 km/h.</p>
<h5 id="graafi_2">Graafi</h5>
<pre class="mermaid"><code>graph TD
    ROOT[Nopeus?] --&gt;|#lt;20.995| ROOT_L[Suihku?]
    ROOT --&gt;|#62;#61;20.995| ROOT_R_LEAF((Autolla))

    ROOT_L --&gt;|Ei| ROOT_L_L[Nopeus?]
    ROOT_L --&gt;|Kyllä| R_L_R_LEAF((Pyörällä))

    ROOT_L_L --&gt;|#60;8.255| ROOT_L_L_L_LEAF((Pyörällä))
    ROOT_L_L --&gt;|#62;#61;8.255| ROOT_L_L_R_LEAF((Autolla))</code></pre>
<h5 id="datan-jaot_2">Datan jaot</h5>
<details class="question">
<summary>Vasen lehti</summary>
<table>
<thead>
<tr>
<th>im_well_rested</th>
<th>dst_has_shower</th>
<th>required_speed</th>
<th>go_by_car</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
<td>5.88</td>
<td>0</td>
</tr>
</tbody>
</table>
</details>
<details class="question">
<summary>Oikea lehti</summary>
<table>
<thead>
<tr>
<th>im_well_rested</th>
<th>dst_has_shower</th>
<th>required_speed</th>
<th>go_by_car</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>10.63</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>14.2</td>
<td>1</td>
</tr>
</tbody>
</table>
</details>
<h2 id="mita-opimme-esimerkista">Mitä opimme esimerkistä?</h2>
<p>Huomaa, että esimerkki koulutettiin vain 16 rivillä dataa. Näin suppealla datalla on luonnollista, että päätöspuun päätelmät eivät aivan edusta todellisuutta. Mikä on todellisuus? Todellisuutta ovat ne luonnonvoimat, jotka ohjaavat ilmiöitä: tässä tapauksessa sitä on käsin koodattu logiikka, joka esiteltiin yllä: <a href="#datan-luomiskertomus">Datan luomiskertomus</a>.</p>
<p>Entäpä jos generoimme enemmän dataa? Alla Decision Tree:n Scikit learn -kirjastolla luotu päätöspuu, joka on koulutettu 293 rivillä dataa. Koodi on yksinkertainen ja helppo ymmärtää, mutta se on myös tehokas ja skaalautuva. Voisimme käyttää myös tähän omaa koodiamme, mutta Scikit-learn tarjoaa mahdollisuuden puun visualisointiin - tätä ei meidän purkkaviritelmästä löydy. Huomaa, että <strong>tarkkuus on kummassakin kuitenkin sama!</strong> Tämän voit testata myöhemmin koodiharjoituksien avulla.</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ml.decision_tree</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dt</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span><span class="p">,</span> <span class="n">plot_tree</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">data_train</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">read_jsonl</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../../data/bike_or_car/293_train.jsonl&quot;</span><span class="p">))</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="n">data_test</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">read_jsonl</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../../data/bike_or_car/100_test.jsonl&quot;</span><span class="p">))</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="n">X_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_train</span><span class="p">]</span> <span class="c1"># First 3 columns</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="n">y_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_train</span><span class="p">]</span> <span class="c1"># Last column</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="n">X_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_test</span><span class="p">]</span> <span class="c1"># Same as above</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="n">y_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_test</span><span class="p">]</span> <span class="c1"># But for test data</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c1"># Build tree (aka fit the model)</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;entropy&quot;</span><span class="p">)</span> <span class="c1"># Default: Gini.</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span></code></pre></div>
<p>Tämän jälkeen voimme visualisoida päätöspuun seuraavasti:</p>
<div class="language-python highlight"><span class="filename">IPython</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">plot_tree</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<p><img alt="Decision Tree Scikit Learn visualisointina" src="../../../images/decision_tree_plot_by_scikit.png" /></p>
<p><strong>Kuvio 1:</strong> <em>Päätöspuu, joka on luotu Scikit-learn-kirjastolla. Graafissa neliön taustaväri indikoi enemmistöluokkaa, joka on kyseisessä solmussa. Sininen viittaa autoon, oranssi pyörään.</em></p>
<p>Huomaa, että nyt päätöspuu on löytänyt luvut, jotka ovat kohtalaisen lähellä meidän määrittelemättömän todellisuuden avainlukuja. Mallista ei löydy tarkkaa <code>20 km/h</code> arvoa, mutta läheltä liippaava <code>19.605 km/h</code> löytyy. Kuinka lähelle totuutta päästiin <code>15 km/h</code> ja <code>10 km/h</code> arvojen kanssa? Lue tämä graafista.</p>
<p>Mallin tarkkuutta voit testata 100 rivillä testidataa, jotka on ladattu <code>data_test</code>-muuttujaan (ja siitä <code>X_test</code> ja <code>y_test</code>-muuttujiin). Tämä onnistuu seuraavalla koodilla:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Predict</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1"># Confusion matrix</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">conf_matrix</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion matrix:&quot;</span><span class="p">)</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TP: </span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="s2">, FN: </span><span class="si">{</span><span class="n">fn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FP: </span><span class="si">{</span><span class="n">fp</span><span class="si">}</span><span class="s2">, TN: </span><span class="si">{</span><span class="n">tn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="p">(</span><span class="n">tp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>Hämmennysmatriisi on seuraavanlainen:</p>
<table>
<thead>
<tr>
<th></th>
<th>Ennuste Autolla</th>
<th>Ennuste Pyörällä</th>
</tr>
</thead>
<tbody>
<tr>
<td>Autolla</td>
<td>71</td>
<td>0</td>
</tr>
<tr>
<td>Pyörällä</td>
<td>1</td>
<td>28</td>
</tr>
</tbody>
</table>
<div class="admonition question">
<p class="admonition-title">Kysymys</p>
<p>Mikä on tämän mallin tarkkuus?</p>
<ul>
<li>0.99</li>
<li>0.97</li>
<li>0.95</li>
<li>Jokin muu, mikä?</li>
</ul>
</div>
<div class="admonition question">
<p class="admonition-title">Kysymys</p>
<p>Miksi yksi False Positive on False Positive? </p>
<ul>
<li>Kyseinen väärin ennustettu havainto näyttää tältä: <code>(1, 1, 19.95, 0)</code>. Kuinka löytäisit tämän koodin avulla? </li>
<li>Missä ennuste menee vikaan? Nimeä oksa, joka on selkeästi väärässä. </li>
<li>Pohdi, kuinka tätä tulosta voisi parantaa.</li>
</ul>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 <a href="https://www.kamk.fi">Kajaanin Ammattikorkeakoulu Oy</a>. 
Licenced under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">BY-NC-ND 4.0</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Kopioitu leikep\u00f6yd\u00e4lle", "clipboard.copy": "Kopioi leikep\u00f6yd\u00e4lle", "search.result.more.one": "1 lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.more.other": "# lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.none": "Ei t\u00e4sm\u00e4\u00e4vi\u00e4 dokumentteja", "search.result.one": "1 t\u00e4sm\u00e4\u00e4v\u00e4 dokumentti", "search.result.other": "# t\u00e4sm\u00e4\u00e4v\u00e4\u00e4 dokumenttia", "search.result.placeholder": "Kirjoita aloittaaksesi haun", "search.result.term.missing": "Puuttuu", "select.version": "Valitse versio"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>